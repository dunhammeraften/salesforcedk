<!--**********************************************************************************************
 * This file is part of the Nebula Logger project, released under the MIT License.               *
 * See LICENSE file or go to https://github.com/jongpie/NebulaLogger for full license details.   *
 **********************************************************************************************-->
<template>
    <div class="main-container height-full slds-p-around_none">
        <div class="slds-is-relative height-full">
            <div
                data-id="split-view-container"
                class="slds-panel slds-size_medium slds-panel_docked slds-panel_docked-left slds-is-open"
                aria-hidden="false"
            >
                <div class="slds-panel__header">
                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                        <div class="slds-media__figure">
                            <lightning-icon
                                icon-name="custom:custom27"
                                alternative-text="settings"
                                title="Stream Settings"
                            ></lightning-icon>
                        </div>
                        <div class="slds-media__body">
                            <h2 class="slds-card__header-title" aria-level="2">
                                <span class="slds-text-heading_small slds-truncate">Stream Settings</span>
                            </h2>
                        </div>
                    </header>
                </div>
                {logLevelFilter}
                <div class="slds-panel__body">
                    <div class="slds-p-horizontal_small">
                        <lightning-input
                            field-level-help={maxEventsToStreamHelp}
                            label="Max Number of Events to Stream"
                            onchange={handleMaxEventsStreamedChange}
                            placeholder="Specify Max Events To Stream"
                            type="number"
                            value={maxEventsToStream}
                        ></lightning-input>
                        <lightning-input
                            label="Max Number of Events to Display"
                            onchange={handleMaxEventsToDisplayChange}
                            placeholder="Specify Max Events"
                            type="number"
                            value={maxEventsToDisplay}
                        ></lightning-input>
                        <lightning-input
                            data-id="loggedByFilter"
                            label="Logged By Id"
                            onchange={handleFilterChange}
                            placeholder="UserId contains"
                            value={loggedByFilter}
                        ></lightning-input>
                        <lightning-input
                            data-id="logLevelFilter"
                            label="Log level"
                            onchange={handleFilterChange}
                            placeholder="Log level contains"
                            value={logLevelFilter}
                        ></lightning-input>
                        <lightning-textarea
                            data-id="originFilter"
                            label="Origin"
                            onchange={handleFilterChange}
                            placeholder="Origin contains"
                            value={originFilter}
                        ></lightning-textarea>
                        <lightning-textarea
                            data-id="messageFilter"
                            label="Message"
                            onchange={handleFilterChange}
                            placeholder="Message contains"
                            value={messageFilter}
                        ></lightning-textarea>
                        <lightning-textarea
                            data-id="traceIdFilter"
                            label="Trace Id"
                            onchange={handleFilterChange}
                            placeholder="Trace Id contains"
                            value={traceIdFilter}
                        ></lightning-textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="slds-grow slds-m-left_small event-stream-container" style="max-height: 65vh">
            <article style="height: 100%; width: 95%" data-id="event-stream-console" class="slds-card">
                <div class="slds-card__header slds-grid">
                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                        <div class="slds-media__body">
                            <h2 class="slds-card__header-title slds-m-left_medium">
                                <span>{title}</span>
                            </h2>
                        </div>
                        <lightning-progress-ring
                            class="slds-m-right_medium"
                            title={eventDeliveryUsageSummary}
                            value={eventDeliveryPercent}
                            variant={eventDeliveryProgressVariant}
                        >
                        </lightning-progress-ring>
                        <div class="slds-no-flex">
                            <lightning-button-group>
                                <lightning-button-stateful
                                    data-id="toggle-stream"
                                    icon-name-when-hover="utility:close"
                                    icon-name-when-off="utility:pause_alt"
                                    icon-name-when-on="utility:play"
                                    label-when-hover="  Pause  "
                                    label-when-off="Paused"
                                    label-when-on="Streaming"
                                    onclick={onToggleStream}
                                    selected={isStreamEnabled}
                                    variant={streamButtonVariant}
                                >
                                </lightning-button-stateful>
                                <lightning-button
                                    data-id="clear"
                                    label="Clear"
                                    icon-name="utility:delete"
                                    name="clear"
                                    onclick={onClear}
                                    variant="destructive"
                                ></lightning-button>
                                <lightning-button-stateful
                                    data-id="expand-toggle"
                                    icon-name-when-off="utility:expand"
                                    icon-name-when-on="utility:contract"
                                    label-when-off="Expand"
                                    label-when-on="Contract"
                                    onclick={onToggleExpand}
                                    selected={isExpanded}
                                    variant="brand"
                                >
                                </lightning-button-stateful>
                            </lightning-button-group>
                        </div>
                    </header>
                </div>
                <div class="slds-p-around_small card-body">
                    <div data-id="event-stream-console" class="slds-p-horizontal_medium event-stream">
                        <template for:each={logEntryEvents} for:item="logEntryEvent">
                            <div key={logEntryEvent.key} class="event-stream-entry">
                                <span class="timestamp">{logEntryEvent.CreatedDate}</span>
                                <span class="logged-by">{logEntryEvent.CreatedById}</span>
                                <span class="trace-id">{logEntryEvent.Trace_Id__c}</span>
                                <span class="log-level">{logEntryEvent.Log_Level__c}</span>
                                <span class="origin">{logEntryEvent.Log_Location__c}</span>
                                <span class="message">{logEntryEvent.Log_Lines__c}</span>
                            </div>
                        </template>
                    </div>
                </div>
            </article>
        </div>
    </div>
</template>